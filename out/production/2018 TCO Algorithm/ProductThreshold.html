<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>You are given an array A that contains <b>N</b> integers, and a positive int <b>limit</b>.</p>

<p>We will use the term <i>subarray</i> to denote any non-empty contiguous segment of the array A. Two subarrays are distinct if they start or end at a different index in A. (Distinct subarrays may contain the same sequence of elements.)</p>

<p>A subarray is called <i>modest</i> if the product of all its elements doesn't exceed <b>limit</b>. Note that a subarray with a negative product is always modest.</p>

<p>Count and return the number of distinct modest subarrays in the given array A.</p>

<p>To keep the input small, the array A is given in the following format:
You are given a non-empty int[] <b>Aprefix</b> and ints <b>spread</b> and <b>offset</b>.
Use the following pseudocode to generate A:
</p>

<pre>
p = length( Aprefix )
for i = 0 .. p-1:
    A[i] = Aprefix[i]
seed = abs( A[p-1] )
for i = p .. N-1:
    seed = (seed * 1103515245 + 12345) modulo 2^31
    A[i] = (seed modulo spread) + offset
</pre></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>ProductThreshold</td></tr><tr><td>Method:</td><td>subarrayCount</td></tr><tr><td>Parameters:</td><td>int, int, int[], int, int</td></tr><tr><td>Returns:</td><td>long</td></tr><tr><td>Method signature:</td><td>long subarrayCount(int N, int limit, int[] Aprefix, int spread, int offset)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>The reference solution does not depend on any properties of the pseudorandom generator.</td></tr><tr><td align="center" valign="top">-</td><td>The last two constraints imply that all elements of A will always be between -10^9 and 10^9, inclusive.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>N</b> will be between 1 and 100,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>limit</b> will be between 1 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>Aprefix</b> will contain between 1 and min(<b>N</b>,500) elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>Aprefix</b> will be between -10^9 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>spread</b> will be between 1 and 2*10^9 + 1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>offset</b> will be greater than or equal to -10^9.</td></tr><tr><td align="center" valign="top">-</td><td><b>spread</b>-1+<b>offset</b> will be less than or equal to 10^9.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>5</pre></td></tr><tr><td><pre>{1,2,3,-4,5}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 13</pre></td></tr><tr><td><table><tr><td colspan="2"><p>We are given the entire sequence A in the array Aprefix.</p>

<p>Modest subarrays are subarrays with product not exceeding 5.</p>

<p>All 8 subarrays that contain the element -4 are modest. Additionally, subarrays {1}, {1,2}, {2}, {3}, and {5} are modest. That gives us a total of 13 modest subarrays.</p></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>10</pre></td></tr><tr><td><pre>8</pre></td></tr><tr><td><pre>{2,2,2,2,2,2,2,2,2,2}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>47</pre></td></tr></table></td></tr><tr><td><pre>Returns: 27</pre></td></tr><tr><td><table><tr><td colspan="2">Each subarray of length 1, 2, or 3 is modest. No other subarray is modest.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>20</pre></td></tr><tr><td><pre>999888777</pre></td></tr><tr><td><pre>{47}</pre></td></tr><tr><td><pre>7654321</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 21</pre></td></tr><tr><td><table><tr><td colspan="2">The array A you should generate looks as follows: {47, 4139827, 3367492, 890643, 113351, 7314474, 5690828, 5571137, 3860068, 2551091, 3662623, 379062, 3134150, 5405018, 2518354, 5390370, 4216741, 5130660, 4174938, 2342215}.

Each one-element subarray is modest, and the subarray {47, 4139827} is also modest.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>8</pre></td></tr><tr><td><pre>{3,0,3,0,3}</pre></td></tr><tr><td><pre>47</pre></td></tr><tr><td><pre>47</pre></td></tr></table></td></tr><tr><td><pre>Returns: 15</pre></td></tr><tr><td><table><tr><td colspan="2">Each subarray of the array {3,0,3,0,3} has a product that does not exceed 8.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1000</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>{-1}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1000</pre></td></tr><tr><td><table><tr><td colspan="2">This array looks as follows: {-1, 2, 2, 2, 2, ...}. Only the substrings that contain the element at index 0 are modest.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>100</pre></td></tr><tr><td><pre>47</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 5050</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>