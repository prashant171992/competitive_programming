<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Alice Margatroid has n dolls sitting on the plane.
You are given their coordinates in the int[]s <b>x</b> and <b>y</b>.
For each valid i, there is a doll sitting at (<b>x</b>[i], <b>y</b>[i]).
<br></br>
<br></br>
Each doll can emit a laser beam along a half-line.
The laser beam must have an angle of exactly 30 degrees with the negative y axis.
There are two possibilities for such a laser beam: either it points "towards bottom left", or "towards bottom right".
<br></br>
<br></br>
Formally, if there is a doll at (x0,y0), it can emit either one of the following two laser beams:
<ul>
<li>The ray consisting of all points (x,y) such that (y - y0) = +sqrt(3) * (x - x0) and y &lt;= y0.</li>
<li>The ray consisting of all points (x,y) such that (y - y0) = -sqrt(3) * (x - x0) and y &lt;= y0.</li>
</ul>

These n rays will divide the plane into multiple regions.
Let f be the number of regions that have a finite area.
<br></br>
<br></br>
Alice can choose which of the two rays each doll emits.
She would like to do that in such a way that f will be as large as possible.
Please calculate and return the largest possible value of f.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>MaidensBunraku</td></tr><tr><td>Method:</td><td>maximal</td></tr><tr><td>Parameters:</td><td>int[], int[]</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int maximal(int[] x, int[] y)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>x</b> will contain between 1 and 2,000, elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>x</b> and <b>y</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>x</b> will be between -1,000,000 and 1,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element in <b>y</b> will be between -1,000,000 and 1,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Points (<b>x</b>[i], <b>y</b>[i]) will be distinct.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{-5,-5,-5,5,5,5}</pre></td></tr><tr><td><pre>{4,5,6,4,5,6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">Alice should set the first three dolls to emit their rays towards the right and the last three dolls to emit their rays towards the left.
The rays will then look as follows:
<pre>
 2            5
  \          /
 1 \        / 4
  \ \      / /
 0 \ \    / / 3
  \ \ \  / / /
   \ \ \/ / /
    \ \/\/ /
     \/\/\/
     /\/\/\
    / /\/\ \
   / / /\ \ \
  / / /  \ \ \
 . . .    . . .
. . .      . . .   
</pre>
In the middle of the figure we can see four finite regions.
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{-1,-1,1,1}</pre></td></tr><tr><td><pre>{4,0,4,0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">Whatever directions Alice chooses for the laser beams, there will never be any finite regions.
For example, if she chooses "right" for the first two dolls and "left" for the last two dolls, we will get the following situation:
<pre>
    0  2
     \/
     /\
    /  \
   /    \
  / 1  3 \
 .   \/   . 
.    /\    .
    /  \
   /    \
  .      .
 .        .
</pre>
Which don't have a closed area.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,3,4,0,1,2,3,4}</pre></td></tr><tr><td><pre>{0,0,0,0,0,1,1,1,1,1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 15</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,2,3,4,5,6,7,8,9}</pre></td></tr><tr><td><pre>{0,1,2,3,4,5,6,7,8,9}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 16</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1000000}</pre></td></tr><tr><td><pre>{-1000000}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>